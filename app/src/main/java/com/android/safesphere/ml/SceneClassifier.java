package com.android.safesphere.ml;

import android.content.Context;
import android.content.res.AssetFileDescriptor;
import android.graphics.Bitmap;
import android.util.Log;

import org.tensorflow.lite.Interpreter;
import org.tensorflow.lite.Tensor;

import java.io.FileInputStream;
import java.io.IOException;
import java.nio.ByteBuffer;
import java.nio.ByteOrder;
import java.nio.channels.FileChannel;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;

public class SceneClassifier {
    private static final String TAG = "SceneClassifier";
    private static final String MODEL_PATH = "clip_model.tflite";
    private static final int INPUT_SIZE = 224;
    private static final int EMBEDDING_SIZE = 512;

    private Interpreter interpreter;
    private final Map<String, Float> sceneRiskMap;
    private final Map<String, float[]> textEmbeddings;

    private static final float SOFTMAX_TEMPERATURE = 0.015f;

    public SceneClassifier(Context context) {
        try {
            interpreter = new Interpreter(loadModelFile(context));
        } catch (IOException e) {
            Log.e(TAG, "Error initializing TensorFlow Lite interpreter.", e);
        }
        sceneRiskMap = new HashMap<>();
        textEmbeddings = new HashMap<>();
        initializeSceneRiskMap();
    }

    private ByteBuffer loadModelFile(Context context) throws IOException {
        AssetFileDescriptor fileDescriptor = context.getAssets().openFd(MODEL_PATH);
        FileInputStream inputStream = new FileInputStream(fileDescriptor.getFileDescriptor());
        FileChannel fileChannel = inputStream.getChannel();
        long startOffset = fileDescriptor.getStartOffset();
        long declaredLength = fileDescriptor.getDeclaredLength();
        return fileChannel.map(FileChannel.MapMode.READ_ONLY, startOffset, declaredLength);
    }

    private void initializeSceneRiskMap() {
        sceneRiskMap.put("a dark alley", 0.9f);
        sceneRiskMap.put("an abandoned building", 0.85f);
        sceneRiskMap.put("a deserted street at night", 0.8f);
        sceneRiskMap.put("a crowded plaza", 0.5f);
        sceneRiskMap.put("a public park during the day", 0.2f);
        sceneRiskMap.put("a well-lit office", 0.1f);

        textEmbeddings.put("a dark alley", new float[]{-0.0204963609576225f, -0.0006519621820189f, 0.0220976639539003f, -0.0102381017059088f, 0.0096575422212481f, -0.0170662775635719f, 0.0232592280954123f, -0.1084455996751785f, 0.0005179006257094f, 0.0171936359256506f, -0.0230505838990211f, -0.0256949402391911f, 0.0040838085114956f, -0.0296494495123625f, 0.0110907340422273f, 0.0255922824144363f, 0.0300560705363750f, -0.0284606143832207f, -0.0146822920069098f, 0.0295376870781183f, 0.0311027839779854f, 0.0162875242531300f, 0.0204909779131413f, -0.0556712523102760f, -0.0297101866453886f, 0.0098177874460816f, -0.0087290825322270f, 0.0134023306891322f, -0.0270380452275276f, -0.0166162047535181f, -0.0031065191142261f, 0.0208218600600958f, -0.0189241990447044f, -0.0115128261968493f, -0.0301520228385925f, 0.0127985747531056f, 0.0037548684049398f, 0.0253753308206797f, -0.0068106497637928f, -0.0015439034905285f, -0.0111349774524570f, 0.0174624118953943f, 0.0550045296549797f, -0.0039314106106758f, 0.0521179735660553f, 0.0196788869798183f, 0.0013438967289403f, -0.0230501070618629f, 0.0390269905328751f, -0.0099857496097684f, 0.0482312627136707f, -0.0477710627019405f, -0.0127799864858389f, -0.0427393913269043f, 0.0432509370148182f, 0.0324674509465694f, 0.0179897211492062f, -0.0212081372737885f, 0.0083567956462502f, 0.0041837603785098f, -0.0040351832285523f, 0.0053087403066456f, 0.0138321360573173f, -0.0174618866294622f, 0.0054421992972493f, -0.0329094529151917f, 0.0127701405435801f, -0.0569481514394283f, -0.0012948516523466f, 0.0359872393310070f, 0.0338739417493343f, -0.0577758774161339f, -0.0010924396337941f, 0.0049185594543815f, 0.0099701071158051f, -0.0211661625653505f, 0.0180106367915869f, -0.0260372217744589f, 0.0428931377828121f, -0.0230513587594032f, -0.0203183982521296f, -0.0192411262542009f, -0.0166402217000723f, 0.0694348588585854f, -0.0042638289742172f, -0.0591372475028038f, 0.0084483269602060f, -0.0061921630986035f, 0.0078651430085301f, -0.0151873668655753f, 0.0520262196660042f, -0.0007325237966143f, -0.1394768804311752f, 0.0558224096894264f, -0.0153584452345967f, -0.0071335961110890f, 0.0339293293654919f, -0.0207712911069393f, 0.0001219324549311f, -0.0249981619417667f, -0.0050284396857023f, -0.0104304999113083f, 0.0152901103720069f, -0.0017104404978454f, 0.0049602468498051f, -0.0246458146721125f, -0.0068887881934643f, 0.0060971262864769f, 0.0223281923681498f, -0.0178498663008213f, 0.0326036103069782f, -0.0170724615454674f, 0.0124692721292377f, 0.0134315146133304f, -0.0077164894901216f, 0.0089311655610800f, -0.0037165000103414f, -0.0325901024043560f, 0.0449009351432323f, -0.0148739488795400f, -0.0382806248962879f, -0.0573560744524002f, -0.0394360907375813f, 0.0025896346196532f, 0.0340272374451160f, 0.0162863712757826f, 0.0097052231431007f, 0.0150424977764487f, 0.0119874449446797f, 0.0159662608057261f, -0.0002751061110757f, 0.0398873165249825f, -0.0089335143566132f, 0.5578957200050354f, -0.0010908724507317f, -0.0342524051666260f, -0.0052597848698497f, -0.0195904560387135f, 0.0098566673696041f, -0.0243450514972210f, -0.0071767512708902f, -0.0201353579759598f, -0.0717205628752708f, 0.0304349530488253f, -0.0135235367342830f, 0.0358340069651604f, -0.0024954976979643f, 0.0273112226277590f, -0.0132287126034498f, 0.0353854596614838f, 0.0211590416729450f, -0.0062524061650038f, 0.0143442125990987f, 0.0324871316552162f, 0.0074514760635793f, 0.0005913611385040f, -0.0222133863717318f, 0.0090166265144944f, 0.0111760292202234f, -0.0193027444183826f, 0.0006662228261121f, 0.0060483817942441f, 0.0178233310580254f, -0.0333942025899887f, 0.0056568104773760f, -0.0066876080818474f, -0.0046998295001686f, 0.0146577777341008f, -0.0045536323450506f, 0.0062982337549329f, 0.0219681002199650f, -0.0200204588472843f, -0.0327632576227188f, 0.0024036318063736f, 0.0285111684352160f, 0.0065239635296166f, -0.0247662179172039f, -0.0237232185900211f, -0.0217015240341425f, -0.0029993467032909f, 0.0296953283250332f, 0.0046315290965140f, -0.0004929766873829f, 0.0031282675918192f, -0.0191145110875368f, -0.0152467573061585f, -0.0506623759865761f, -0.0368230678141117f, -0.0805541723966599f, 0.0025320374406874f, 0.0145577946677804f, -0.0025737595278770f, -0.0467653721570969f, 0.0082692718133330f, 0.0173399746417999f, 0.0072410167194903f, -0.0657213404774666f, 0.0194291863590479f, -0.0061323922127485f, -0.0076545001938939f, -0.0044814608991146f, 0.0089855575934052f, 0.0320443511009216f, 0.0586148463189602f, -0.0455079339444637f, 0.0206560250371695f, 0.0227989628911018f, -0.0375773645937443f, 0.0066077122464776f, -0.0202725268900394f, 0.0610593073070049f, 0.0259893946349621f, -0.0237073358148336f, -0.0197680685669184f, 0.0157704558223486f, -0.0035385044757277f, -0.0048511903733015f, 0.0063886051066220f, -0.0017527934396639f, -0.0271830521523952f, -0.0442155711352825f, 0.0050748982466757f, 0.0021165027283132f, 0.0036222038324922f, 0.0113213369622827f, -0.0239347461611032f, -0.0027140630409122f, 0.0010211040498689f, 0.0396729484200478f, -0.0079062823206186f, 0.0363597609102726f, -0.0322134383022785f, -0.0191739331930876f, -0.0152919776737690f, -0.0076986071653664f, 0.0648160204291344f, -0.0021595470607281f, 0.0320874415338039f, 0.0037982598878443f, -0.0289979707449675f, 0.0157246738672256f, 0.0096241999417543f, -0.0365262366831303f, 0.0376193709671497f, 0.0023481824900955f, 0.0212034340947866f, -0.0226851571351290f, -0.0261612776666880f, 0.0086320433765650f, 0.0124733541160822f, 0.0024274294264615f, 0.0252672955393791f, -0.0104310922324657f, -0.0007586476276629f, 0.0538531579077244f, 0.0100426804274321f, -0.0081221172586083f, -0.0002350390423089f, -0.0050455578602850f, 0.0183772388845682f, 0.0220282822847366f, -0.0417430736124516f, -0.0101488865911961f, -0.0157053116708994f, -0.0368626564741135f, -0.0301952380686998f, -0.0006325841532089f, -0.0143799055367708f, -0.0189847517758608f, -0.0086823171004653f, -0.0030650536064059f, 0.0111183654516935f, 0.0359045527875423f, -0.0442461892962456f, -0.0292222388088703f, 0.0004617839877028f, -0.0176596008241177f, -0.0309655033051968f, 0.0148686924949288f, -0.0162941031157970f, 0.0233028661459684f, 0.0246855560690165f, -0.0276700053364038f, 0.0212470516562462f, -0.0163159612566233f, -0.0246004424989223f, 0.0202318187803030f, 0.0261102728545666f, -0.0020362425129861f, -0.0257892664521933f, -0.0010694368975237f, 0.0013691897038370f, 0.0071811489760876f, 0.0172612220048904f, -0.0400085039436817f, -0.0305739901959896f, -0.0352418087422848f, 0.0254394970834255f, 0.0136841638013721f, -0.0194695312529802f, -0.0135824559256434f, 0.0363399088382721f, -0.0022795856930315f, -0.0171746294945478f, 0.0380716845393181f, -0.0155086796730757f, -0.0103111192584038f, 0.0275064986199141f, 0.0038074587937444f, 0.0056614759378135f, -0.0362866483628750f, 0.0075726630166173f, 0.5567938089370728f, 0.0125935142859817f, 0.0069832582958043f, 0.0176524557173252f, -0.0054317493923008f, 0.0030471112113446f, 0.0209234487265348f, 0.0073724049143493f, 0.0332188270986080f, 0.0394373163580894f, 0.0269113536924124f, -0.0143632441759109f, 0.0264820829033852f, 0.0403657779097557f, -0.0122873717918992f, 0.0200546532869339f, -0.0056438157334924f, -0.2015525847673416f, -0.0183334164321423f, 0.0252953190356493f, -0.0130100855603814f, 0.0056788465008140f, 0.0039171804673970f, -0.0279200058430433f, 0.0068367635831237f, 0.0178040396422148f, -0.0066548786126077f, 0.0394728556275368f, -0.0104085281491280f, 0.0147043857723475f, -0.0044534816406667f, -0.0041918023489416f, 0.0074966023676097f, -0.0106872925534844f, 0.0398672707378864f, -0.0037636961787939f, 0.0138001302257180f, 0.0081193335354328f, 0.0085267666727304f, -0.0331101678311825f, 0.0207336582243443f, -0.0023787887766957f, -0.0086092064157128f, 0.0128140551969409f, -0.0148444976657629f, 0.0080391978845000f, -0.0229914616793394f, 0.0124836908653378f, -0.0179839916527271f, -0.0200927276164293f, 0.0491193495690823f, 0.0395476035773754f, 0.0450956784188747f, -0.0201764162629843f, -0.0225766021758318f, 0.0070739956572652f, 0.0006723303231411f, 0.0617646165192127f, 0.0226349756121635f, -0.0301493424922228f, -0.0128477681428194f, -0.0026428755372763f, -0.0236444324254990f, -0.0056051108986139f, -0.0138941844925284f, 0.0458016283810139f, -0.0208007544279099f, 0.0141724059358239f, 0.0081926127895713f, 0.0341384597122669f, -0.0194192864000797f, -0.0296136327087879f, -0.0045492486096919f, -0.0209423154592514f, -0.0100351274013519f, -0.0059194415807724f, -0.0357745066285133f, -0.0052250679582357f, 0.0038427857216448f, 0.0229812581092119f, 0.0309310797601938f, 0.0062637357041240f, -0.0297163296490908f, 0.0135767329484224f, 0.0329602845013142f, 0.0311440490186214f, 0.0278937015682459f, 0.0196765549480915f, 0.0553065314888954f, -0.0205820649862289f, -0.0508672595024109f, 0.0085720922797918f, 0.0048406454734504f, -0.0231211762875319f, -0.0016361541347578f, -0.0213563367724419f, 0.0052548623643816f, -0.0316981263458729f, -0.0129789998754859f, -0.0004087818088010f, -0.0188153479248285f, 0.0187821537256241f, 0.0334168337285519f, 0.0479679480195045f, 0.0280421841889620f, 0.0136975478380919f, -0.0038221064023674f, 0.0128260124474764f, 0.0449711196124554f, -0.0103960959240794f, -0.0201816447079182f, -0.0213054791092873f, -0.0012306791031733f, 0.0147194508463144f, -0.0165713727474213f, 0.0055035585537553f, 0.0383706279098988f, -0.0012029663193971f, 0.0085678147152066f, -0.0028348213527352f, -0.0444081798195839f, 0.0168979652225971f, 0.0254299473017454f, 0.0115365833044052f, -0.0150232501327991f, -0.0028704674914479f, -0.0056860102340579f, -0.0196851044893265f, 0.0089689018204808f, -0.0353013277053833f, 0.0160683225840330f, 0.0037146909162402f, -0.0049395523965359f, -0.0037053169216961f, 0.0126007543876767f, -0.0350698158144951f, -0.0359628200531006f, -0.0104029411450028f, -0.0075205466710031f, 0.0231140442192554f, -0.0572119764983654f, 0.0305599942803383f, -0.0210456885397434f, -0.0037624568212777f, 0.0202491860836744f, -0.0445501916110516f, 0.0346570834517479f, -0.0209694672375917f, 0.0386857800185680f, 0.0304718669503927f, -0.0022418871521950f, -0.0018230542773381f, 0.0135283805429935f, 0.0421457514166832f, 0.0382923483848572f, -0.0041748019866645f, 0.0053886696696281f, -0.0302020963281393f, -0.0172257609665394f, -0.0084626115858555f, -0.0072564585134387f, -0.0261309072375298f, 0.0121111357584596f, -0.0008074740180746f, 0.0416144430637360f, -0.0196745693683624f, 0.0211542043834925f, 0.0032478601206094f, 0.0257750917226076f, -0.0435003824532032f, -0.0165477432310581f, -0.0042174197733402f, 0.0092765521258116f, -0.0026162222493440f, -0.0023994934745133f, -0.0038327735383064f, 0.0178787522017956f, -0.0085243517532945f, 0.0096001671627164f, 0.0438000708818436f, -0.0366284698247910f, 0.0556152462959290f, 0.0187781564891338f, -0.0374704934656620f, -0.0001431131531717f, -0.0278778411448002f, 0.0136151788756251f, 0.0104879504069686f, 0.0189374834299088f, -0.0679441839456558f, -0.0207822285592556f, 0.0465840958058834f, 0.0094893826171756f, -0.0130098843947053f, -0.0163283403962851f, -0.0161037575453520f, 0.0214080717414618f, -0.0245129130780697f, 0.0149124395102262f, 0.0151677830144763f});
        textEmbeddings.put("an abandoned building", new float[]{0.0178438443690538f, 0.0149937532842159f, 0.0040781223215163f, 0.0101364012807608f, -0.0001796001160983f, -0.0128806317225099f, 0.0135421035811305f, -0.0586771070957184f, -0.0258813463151455f, 0.0008501058327965f, 0.0055198548361659f, -0.0227697212249041f, 0.0111284777522087f, -0.0127954063937068f, 0.0189597606658936f, 0.0119486926123500f, -0.0113908955827355f, 0.0362631157040596f, -0.0041852407157421f, 0.0040336996316910f, 0.0907047018408775f, -0.0228924565017223f, 0.0497539751231670f, -0.0193230472505093f, -0.0164123475551605f, 0.0382380522787571f, -0.0080949729308486f, 0.0034575199242681f, -0.0070033846423030f, 0.0039076083339751f, -0.0001897891779663f, -0.0431850329041481f, 0.0022103104274720f, -0.0149962063878775f, -0.0378783456981182f, -0.0297008194029331f, 0.0021268753334880f, 0.0243665464222431f, 0.0066604828462005f, 0.0031167005654424f, -0.0287212952971458f, 0.0096352668479085f, 0.0117768598720431f, -0.0355482026934624f, 0.0320082716643810f, -0.0014438251964748f, 0.0233516432344913f, -0.0156801659613848f, 0.0109702972695231f, 0.0210596397519112f, 0.0250660870224237f, -0.0199700277298689f, -0.0113879162818193f, 0.0013700640993193f, 0.0276502314954996f, 0.0018778783269227f, -0.0401368103921413f, -0.0255567226558924f, -0.0117398258298635f, -0.0146419955417514f, -0.0192969571799040f, -0.0333957709372044f, 0.0122013874351978f, -0.0353652648627758f, 0.0016188123263419f, 0.0127464570105076f, 0.0338263362646103f, -0.0104825524613261f, 0.0046391012147069f, -0.0286886226385832f, -0.0444033816456795f, -0.0156695973128080f, -0.0059698047116399f, -0.0683162063360214f, 0.0207438636571169f, -0.0085783926770091f, 0.0241067726165056f, 0.0386962443590164f, 0.0064669437706470f, 0.0067625050432980f, 0.0024271903093904f, -0.0137781184166670f, 0.0015249227872118f, 0.0322086736559868f, -0.0071740490384400f, -0.0042446432635188f, 0.0099623408168554f, 0.0037402173038572f, -0.0230237543582916f, 0.0086633283644915f, 0.0033991297241300f, 0.0143979573622346f, -0.1017392873764038f, 0.0584059506654739f, 0.0194305554032326f, -0.0061314124614000f, -0.0203410591930151f, 0.0199741981923580f, -0.0142680890858173f, -0.0561823286116123f, 0.0083482982590795f, 0.0030308426357806f, 0.0076366378925741f, 0.0011887820437551f, -0.0064637749455869f, -0.0087104747071862f, -0.0034191247541457f, 0.0046962704509497f, 0.0409954376518726f, -0.0108240144327283f, 0.0171778108924627f, -0.0187922082841396f, 0.0290717240422964f, 0.0064975577406585f, 0.0256372038275003f, 0.0409854836761951f, -0.0210760645568371f, -0.0033981362357736f, 0.0263345912098885f, -0.0008553910301998f, 0.0429575815796852f, -0.0381440818309784f, 0.0375933684408665f, -0.0161698684096336f, 0.0245136376470327f, -0.0125509276986122f, -0.0221732202917337f, 0.0271908473223448f, -0.0060032601468265f, 0.0406284183263779f, -0.0044869505800307f, 0.0383742190897465f, -0.0228043254464865f, 0.5807146430015564f, -0.0203032419085503f, 0.0095455683767796f, 0.0434042327105999f, -0.0510657429695129f, 0.0098898336291313f, -0.0056503564119339f, 0.0221223048865795f, 0.0127140190452337f, -0.0490827076137066f, 0.0413928367197514f, -0.0062823500484228f, -0.0158825758844614f, 0.0040649506263435f, -0.0003245748521294f, -0.0198351666331291f, 0.0116575909778476f, -0.0314322784543037f, 0.0014814928872511f, -0.0016818470321596f, 0.0624318718910217f, -0.0100912349298596f, 0.0091472500935197f, 0.0176106970757246f, 0.0080656558275223f, -0.0045686000958085f, -0.0352330058813095f, -0.0111565254628658f, 0.0192182566970587f, -0.0068795457482338f, -0.0077197430655360f, 0.0185541510581970f, -0.0189501717686653f, 0.0176059491932392f, -0.0082788504660130f, -0.0293595641851425f, -0.0024002999998629f, 0.0277681779116392f, 0.0150968087837100f, -0.0014024598058313f, 0.0076033030636609f, -0.0136005748063326f, 0.0194254014641047f, -0.0084474328905344f, -0.0131613491103053f, -0.0147617440670729f, 0.0131698334589601f, -0.0012239823117852f, 0.0488740056753159f, -0.0209660436958075f, 0.0064490782096982f, 0.0048586740158498f, 0.0189141407608986f, -0.0098537970334291f, -0.0502201579511166f, 0.0067443032748997f, 0.0049643064849079f, 0.0052225524559617f, -0.0149908764287829f, -0.0189813673496246f, 0.0000806908574305f, -0.0312579758465290f, -0.0108979931101203f, 0.0124670909717679f, -0.0080940434709191f, 0.0126798804849386f, -0.0170328933745623f, -0.0387101732194424f, -0.0230156630277634f, 0.0191344674676657f, 0.0000487210636493f, -0.0640217587351799f, -0.0189152788370848f, 0.0464627891778946f, 0.0212041884660721f, -0.0030254130251706f, -0.0456998646259308f, 0.0506486780941486f, 0.0129723083227873f, 0.0113086365163326f, 0.0509221628308296f, 0.0522595010697842f, -0.0117737669497728f, -0.0170214716345072f, 0.0117375133559108f, 0.0058643952943385f, -0.0142483701929450f, -0.0168405845761299f, 0.0176976416260004f, -0.0071508297696710f, -0.0036844364367425f, -0.0149812279269099f, -0.0269918199628592f, -0.0008925231522880f, -0.0428691320121288f, -0.0198918953537941f, -0.0150389736518264f, 0.0266664829105139f, -0.0049865860491991f, 0.0114997820928693f, -0.0039347121492028f, 0.0115549294278026f, 0.0719135180115700f, -0.0083115259185433f, 0.0249712336808443f, -0.0319086946547031f, 0.0007163129048422f, 0.0308746285736561f, -0.0064491545781493f, -0.0276561137288809f, 0.0146898049861193f, -0.0136277107521892f, 0.0482603423297405f, -0.0021228727418929f, -0.0133019909262657f, -0.0215898342430592f, 0.0042691971175373f, 0.0224761459976435f, -0.0020113675855100f, 0.0104235103353858f, 0.0295160580426455f, -0.0192766189575195f, 0.0210312828421593f, -0.0144635215401649f, 0.0047096475027502f, 0.0254411306232214f, 0.0583602376282215f, -0.0024137273430824f, 0.0434259809553623f, 0.0023569471668452f, 0.0038283511530608f, -0.0052634431049228f, -0.0193252023309469f, 0.0486259385943413f, -0.0216576773673296f, -0.0177720393985510f, 0.0126449856907129f, -0.0311094000935555f, 0.0117699438706040f, -0.0088242758065462f, -0.0287837069481611f, -0.0058950218372047f, -0.0029158177785575f, -0.0292756371200085f, 0.0015497659333050f, 0.0280439890921116f, -0.0163082331418991f, 0.0112310014665127f, -0.0040443688631058f, -0.0207546092569828f, 0.0253219548612833f, -0.0344957783818245f, 0.0261397026479244f, 0.0058260303921998f, 0.0442526154220104f, -0.0079402495175600f, -0.0258505959063768f, 0.0284449309110641f, -0.0095250448212028f, -0.0361836701631546f, -0.0169137921184301f, -0.0232641976326704f, -0.0418106503784657f, -0.0195838846266270f, 0.0222582165151834f, 0.0216587446630001f, 0.0050559695810080f, 0.0166491549462080f, -0.0202908702194691f, -0.0110403550788760f, 0.0108262905851007f, -0.0281075853854418f, -0.0411501340568066f, 0.0166515614837408f, 0.0067349765449762f, -0.0080838762223721f, -0.0251919142901897f, -0.0281779281795025f, -0.0015169269172475f, 0.5807851552963257f, -0.0412321984767914f, 0.0453026294708252f, -0.0105689242482185f, -0.0133381094783545f, -0.0469779372215271f, -0.0096523510292172f, -0.0368573702871799f, 0.0031101319473237f, 0.0589878186583519f, 0.0380952507257462f, -0.0202327668666840f, -0.0363399162888527f, 0.0306967794895172f, 0.0321851037442684f, -0.0320822857320309f, 0.0162061508744955f, -0.1139817014336586f, -0.0217610578984022f, -0.0157674178481102f, -0.0308744981884956f, -0.0034776763059199f, 0.0087477955967188f, 0.0066601806320250f, 0.0123422108590603f, -0.0255224555730820f, 0.0006922725006007f, 0.0304986517876387f, 0.0074205594137311f, 0.0032445695251226f, -0.0211898367851973f, 0.0106384456157684f, 0.0496641844511032f, 0.0080267116427422f, -0.0080208145081997f, 0.0207274854183197f, -0.0151313999667764f, -0.0223553385585546f, 0.0174219552427530f, -0.0511663332581520f, 0.0076238317415118f, 0.0160842146724463f, -0.0583954900503159f, -0.0103428782895207f, -0.0102225746959448f, 0.0322101972997189f, 0.0153711987659335f, 0.0186405200511217f, -0.0460908524692059f, -0.0091257542371750f, 0.0069564823061228f, 0.0595707148313522f, 0.0173258762806654f, -0.0085292970761657f, 0.0254127550870180f, 0.0200587920844555f, -0.0388645380735397f, 0.0052677048370242f, 0.0162951350212097f, 0.0015980338212103f, -0.0145444180816412f, 0.0093631949275732f, -0.0243062730878592f, -0.0166699234396219f, -0.0211032051593065f, -0.0092853009700775f, -0.0204897671937943f, 0.0577677711844444f, 0.0427203103899956f, 0.0401854552328587f, -0.0083766272291541f, -0.0129485083743930f, -0.0016782631864771f, -0.0240315515547991f, -0.0183598734438419f, 0.0234708767384291f, -0.0153643516823649f, 0.0018528101500124f, -0.0376290529966354f, 0.0472919903695583f, 0.0086816782131791f, 0.0130388839170337f, -0.0144691122695804f, 0.0239805653691292f, 0.0098508019000292f, 0.0312779434025288f, -0.0027576053980738f, 0.0287693981081247f, 0.0027284619864076f, -0.0052564633078873f, -0.0238509923219681f, 0.0097877830266953f, 0.0071494667790830f, -0.0191433466970921f, -0.0192630700767040f, -0.0282600000500679f, -0.0102492328733206f, -0.0280163791030645f, -0.0296081472188234f, -0.0117035955190659f, 0.0233088657259941f, 0.0118773467838764f, 0.0338410697877407f, 0.0174783635884523f, 0.0132341068238020f, -0.0265615172684193f, 0.0001768137735780f, 0.0550232939422131f, -0.0014436715282500f, 0.0164110753685236f, 0.0216937363147736f, -0.0446553379297256f, -0.0130314407870173f, 0.0165002085268497f, -0.0099106431007385f, 0.0166661236435175f, 0.0249165426939726f, 0.0021168875973672f, 0.0366768054664135f, -0.0306112933903933f, -0.0227506663650274f, 0.0119194574654102f, -0.0114639988169074f, -0.0178918782621622f, -0.0308926552534103f, -0.0062274369411170f, 0.0027782681863755f, -0.0218036659061909f, 0.0089267827570438f, -0.0223598368465900f, 0.0144912404939532f, -0.0265389084815979f, 0.0278561264276505f, 0.0177611708641052f, 0.0118387304246426f, -0.0173820592463017f, 0.0248017851263285f, 0.0013040699996054f, -0.0192276928573847f, -0.0103569524362683f, -0.0058428421616554f, 0.0420011505484581f, -0.0115942033007741f, 0.0116836465895176f, 0.0105704832822084f, 0.0158503558486700f, -0.0051806769333780f, 0.0358713939785957f, -0.0133351562544703f, 0.0253519527614117f, -0.0020514517091215f, 0.0446625091135502f, 0.0307256169617176f, -0.0318274088203907f, -0.0258910171687603f, -0.0118126990273595f, 0.0030017015524209f, 0.0026637203991413f, -0.0078986221924424f, -0.0504275523126125f, -0.0053085940890014f, -0.0006259575020522f, 0.0222431421279907f, -0.0396046340465546f, -0.0427925176918507f, 0.0252080131322145f, 0.0254773236811161f, -0.0013232097262517f, 0.0030320677906275f, -0.0503649972379208f, -0.0124208424240351f, 0.0352318622171879f, 0.0416890718042850f, 0.0031081805936992f, 0.0162496808916330f, -0.0227088294923306f, -0.0122900614514947f, -0.0433640666306019f, 0.0185617189854383f, -0.0090641258284450f, 0.0049733626656234f, 0.0580792613327503f, 0.0074462080374360f, -0.0048476802185178f, -0.0083685908466578f, -0.0056624640710652f, 0.0158215314149857f, 0.0157251842319965f, 0.0201875958591700f, -0.0049165948294103f, -0.0012987471418455f, 0.0235906708985567f, 0.0474361255764961f, 0.0211299974471331f, 0.0122401602566242f, 0.0249594971537590f, 0.0368314422667027f, -0.0277009718120098f, 0.0104425372555852f, -0.0349970348179340f});
        textEmbeddings.put("a deserted street at night", new float[]{-0.0379363149404526f, -0.0108696045354009f, -0.0124436672776937f, -0.0380301885306835f, 0.0176080502569675f, 0.0166098568588495f, -0.0290903318673372f, -0.0688213333487511f, -0.0235493816435337f, 0.0167089197784662f, 0.0252355951815844f, -0.0148396985605359f, 0.0766914188861847f, -0.0124232498928905f, -0.0152852246537805f, 0.0383571572601795f, 0.0260158870369196f, 0.0210370458662510f, -0.0225108172744513f, 0.0092723350971937f, 0.0119999013841152f, 0.0187052115797997f, 0.0022097309119999f, -0.0620343163609505f, -0.0236455220729113f, 0.0801280140876770f, -0.0117280138656497f, -0.0057766754180193f, -0.0156836714595556f, -0.0319842994213104f, 0.0005662448820658f, 0.0027760700322688f, -0.0041200029663742f, -0.0016658422537148f, -0.0809690728783607f, 0.0092170527204871f, 0.0360219441354275f, 0.0668158158659935f, -0.0259695854038000f, 0.0071007721126080f, -0.0485705323517323f, 0.0090107368305326f, 0.0423012226819992f, 0.0312401074916124f, 0.0166925806552172f, 0.0284743495285511f, -0.0222107842564583f, -0.0026024237740785f, 0.0543069690465927f, -0.0039559085853398f, 0.0449689403176308f, -0.0246536880731583f, -0.0074006631039083f, -0.0655547603964806f, -0.0076790759339929f, -0.0181722566485405f, 0.0350193157792091f, 0.0160260647535324f, 0.0126016149297357f, -0.0324028171598911f, -0.0295421350747347f, 0.0200381558388472f, -0.0341884382069111f, 0.0006529919337481f, -0.0015210781712085f, -0.0310666076838970f, 0.0137689905241132f, -0.0461814142763615f, -0.0023748935200274f, 0.0074155875481665f, 0.0373223833739758f, -0.0155734950676560f, 0.0362732857465744f, 0.0210056733340025f, 0.0135795865207911f, -0.0207485090941191f, 0.0161229074001312f, 0.0070316931232810f, 0.0407773293554783f, -0.0062224105931818f, -0.0384660176932812f, -0.0157441999763250f, -0.0359245389699936f, 0.0754306539893150f, -0.0127818090841174f, -0.0618549808859825f, 0.0398488938808441f, 0.0011194708058611f, 0.0093960063531995f, -0.0031760642305017f, -0.0213872808963060f, -0.0397215746343136f, -0.0906911715865135f, 0.0369073562324047f, 0.0298083629459143f, -0.0291957482695580f, 0.0054192845709622f, -0.0066732256673276f, -0.0015659442869946f, -0.0712975189089775f, 0.0215819384902716f, 0.0390345901250839f, 0.0351537652313709f, -0.0049117817543447f, 0.0014219420263544f, -0.0359612405300140f, -0.0185981355607510f, 0.0354376472532749f, 0.0289510395377874f, -0.0592416003346443f, -0.0325739718973637f, -0.0618913955986500f, -0.0036408181767911f, 0.0106405150145292f, -0.0076336548663676f, 0.0443110428750515f, -0.0353438183665276f, -0.0173940993845463f, 0.0414069965481758f, -0.0056869601830840f, 0.0197490788996220f, -0.0725166350603104f, 0.0154996216297150f, -0.0410455949604511f, -0.0007528378628194f, -0.0451489575207233f, 0.0167146772146225f, -0.0070401886478066f, 0.0057097868993878f, 0.0159373115748167f, -0.0192561149597168f, 0.0226877126842737f, 0.0110752405598760f, 0.4887673854827881f, -0.0059845657087862f, 0.0214185919612646f, -0.0159960519522429f, -0.0288290251046419f, 0.0366933606564999f, -0.0356337763369083f, -0.0232861116528511f, -0.0170918032526970f, -0.0905785039067268f, 0.0322973243892193f, 0.0158444698899984f, 0.0155493710190058f, -0.0298069994896650f, -0.0570608302950859f, -0.0354798175394535f, -0.0073412242345512f, -0.0027611178811640f, -0.0181092713028193f, -0.0025876017753035f, 0.0286941640079021f, -0.0014838424976915f, 0.0036471597850323f, -0.0006574750877917f, 0.0196260716766119f, 0.0084580415859818f, -0.0041212579235435f, 0.0236038975417614f, 0.0142487045377493f, 0.0370047949254513f, -0.0435058064758778f, 0.0013047346146777f, 0.0001233527873410f, 0.0252626668661833f, -0.0280496943742037f, -0.0705714374780655f, -0.0113396337255836f, -0.0159196946769953f, 0.0136792920529842f, -0.0054253512062132f, 0.0187630411237478f, 0.0120841767638922f, 0.0022077977191657f, -0.0321018695831299f, -0.0339207164943218f, -0.0012962905457243f, -0.0134531660005450f, 0.0809696167707443f, 0.0232043173164129f, 0.0089901862666011f, -0.0451472327113152f, -0.0079025737941265f, 0.0043261749669909f, -0.0158088747411966f, 0.0104948775842786f, -0.0660393983125687f, 0.0601201653480530f, -0.0170382261276245f, 0.0058371853083372f, -0.0322620980441570f, -0.0173053890466690f, 0.0110070062801242f, 0.0097104003652930f, -0.0135270552709699f, 0.0079601071774960f, -0.0267079602926970f, 0.0062176822684705f, -0.0320687815546989f, -0.0001904997916427f, 0.0418572947382927f, 0.0274441782385111f, -0.0216152835637331f, -0.0088647985830903f, 0.0085768857970834f, -0.0240958184003830f, 0.0051955692470074f, -0.0070978719741106f, 0.0459653176367283f, 0.0592723973095417f, -0.0280978474766016f, 0.0223575402051210f, 0.0353810563683510f, -0.0203632358461618f, -0.0045307097025216f, -0.0527602434158325f, -0.0089591545984149f, -0.0160812865942717f, 0.0122404219582677f, 0.0479105971753597f, -0.0048386012203991f, 0.0513849370181561f, 0.0062646013684571f, -0.0099613368511200f, -0.0003700491506606f, -0.0606909133493900f, -0.0208172723650932f, -0.0135797327384353f, 0.0294593051075935f, -0.0360972993075848f, -0.0133170839399099f, 0.0048965262249112f, -0.0365999154746532f, 0.1014814823865891f, -0.0066117160022259f, 0.0222885236144066f, -0.0170869976282120f, -0.0132902236655354f, 0.0392046943306923f, -0.0041630039922893f, -0.0600110776722431f, 0.0386047847568989f, -0.0091508086770773f, -0.0129905985668302f, -0.0063508823513985f, 0.0113637438043952f, -0.0043853134848177f, -0.0016560306539759f, 0.0063330931589007f, 0.0283141415566206f, 0.0107382200658321f, 0.0257120691239834f, 0.0233581885695457f, 0.0396692827343941f, -0.0414455980062485f, 0.0309625063091516f, -0.0177976991981268f, 0.0246096048504114f, 0.0199523251503706f, -0.0200253427028656f, -0.0052511142566800f, 0.0107489917427301f, -0.0486208833754063f, -0.0081944297999144f, 0.0115506704896688f, -0.0134102543815970f, 0.0134953577071428f, 0.0018798403907567f, -0.0342226959764957f, 0.0500216744840145f, 0.0413148775696754f, -0.0284073166549206f, -0.0509528554975986f, -0.0241242945194244f, -0.0323786064982414f, -0.0053452164866030f, -0.0277888178825378f, -0.0034040799364448f, 0.0197048820555210f, 0.0035068341530859f, -0.0258788727223873f, 0.0066619729623199f, -0.0327215082943439f, -0.0453015528619289f, 0.0061267330311239f, 0.0109477285295725f, 0.0641807094216347f, -0.0359795466065407f, -0.0208535101264715f, 0.0124547844752669f, 0.0179327074438334f, 0.0044298083521426f, -0.0185842178761959f, 0.0157201401889324f, -0.0576583445072174f, 0.0152923353016376f, 0.0495546758174896f, -0.0322189368307590f, -0.0289000421762466f, -0.0004462270007934f, 0.0372176952660084f, -0.0242635402828455f, -0.0024348453152925f, -0.0457961745560169f, -0.0131256114691496f, 0.0019768346101046f, 0.0093300854787230f, 0.0096230795606971f, -0.0534456968307495f, 0.0070457840338349f, 0.4880380332469940f, -0.0168325416743755f, 0.0169547833502293f, -0.0278202071785927f, 0.0008922616252676f, -0.0305641070008278f, 0.0145929474383593f, -0.0337705947458744f, 0.0002487400488462f, 0.0537374392151833f, 0.0124383959919214f, -0.0327842980623245f, 0.0020612375810742f, 0.0601615346968174f, 0.0160865858197212f, 0.0521971359848976f, 0.0346060134470463f, -0.1073994934558868f, -0.0062053916044533f, 0.0107037099078298f, -0.0171183962374926f, -0.0077971178106964f, -0.0102138705551624f, -0.0018919148715213f, -0.0029592304490507f, -0.0027376881334931f, 0.0339008942246437f, 0.0585677698254585f, -0.0215641483664513f, -0.0320568680763245f, 0.0359941832721233f, -0.0004500749637373f, 0.0534809082746506f, 0.0112325679510832f, 0.0416692569851875f, 0.0220282711088657f, -0.0216126386076212f, -0.0410106889903545f, -0.0364016033709049f, 0.0014699721941724f, 0.0448984056711197f, 0.0007221729611047f, -0.0610732734203339f, -0.0336250141263008f, -0.0277188848704100f, 0.0291724000126123f, -0.0223984047770500f, -0.0088419765233994f, -0.0210542529821396f, 0.0284082237631083f, 0.0363006405532360f, 0.0525226294994354f, 0.0063678487204015f, -0.0767782852053642f, 0.0050956876948476f, 0.0412138216197491f, -0.0054267691448331f, 0.0311155319213867f, 0.0136734871193767f, -0.0142302475869656f, 0.0023566538002342f, 0.0164196304976940f, 0.0255886986851692f, -0.0198996234685183f, -0.0195074547082186f, 0.0363416709005833f, 0.0176471602171659f, 0.0583993308246136f, 0.0112668219953775f, 0.0561793670058250f, 0.0111572463065386f, -0.0330538451671600f, -0.0327404439449310f, 0.0006787495804019f, -0.0751743465662003f, -0.0122948912903666f, -0.0259699262678623f, 0.0302161332219839f, -0.0107736848294735f, 0.0541909150779247f, 0.0019046236993745f, 0.0636300966143608f, 0.0019932037685066f, 0.0064258645288646f, 0.0356475561857224f, -0.0057822982780635f, 0.0821124464273453f, 0.0143418963998556f, 0.0332461968064308f, -0.0369716957211494f, -0.0450230948626995f, 0.0035561108961701f, -0.0384714119136333f, -0.0177198406308889f, -0.0161104034632444f, -0.0454981476068497f, 0.0199169386178255f, 0.0126633029431105f, -0.0000241631187237f, 0.0019111279398203f, 0.0542932599782944f, 0.0119015062227845f, 0.0260319896042347f, 0.0472338162362576f, -0.0115853650495410f, -0.0194346848875284f, -0.0063178674317896f, 0.0313194803893566f, 0.0769538730382919f, -0.0317604541778564f, -0.0287409126758575f, -0.0795293301343918f, 0.0200377199798822f, -0.0032759800087661f, -0.0013362574391067f, 0.0065996572375298f, 0.0246430672705173f, -0.0023327437229455f, -0.0443659983575344f, 0.0024075414985418f, -0.0519500635564327f, 0.0028716097585857f, 0.0062648244202137f, 0.0201868303120136f, -0.0384703651070595f, 0.0066161011345685f, 0.0042110322974622f, 0.0052814614027739f, 0.0184645876288414f, -0.0564269237220287f, 0.0084311319515109f, 0.0057118437252939f, 0.0366202481091022f, -0.0197557192295790f, 0.0164702925831079f, -0.0427563190460205f, -0.0162065550684929f, -0.0234005767852068f, -0.0058920751325786f, 0.0322956219315529f, -0.0303175766021013f, 0.0625678822398186f, -0.0283289663493633f, -0.0110824229195714f, 0.0700809881091118f, -0.0176139846444130f, 0.0359686836600304f, -0.0485733896493912f, 0.0440679006278515f, -0.0007074248278514f, -0.0051228371448815f, 0.0387201867997646f, 0.0555059500038624f, 0.0287996362894773f, 0.0065636327490211f, -0.0033506068866700f, -0.0286042299121618f, 0.0094001181423664f, -0.0089702801778913f, -0.0185327511280775f, -0.0365213416516781f, -0.0484505109488964f, 0.0048628514632583f, -0.0380048938095570f, 0.0523417815566063f, -0.0218824204057455f, -0.0010126177221537f, 0.0182569790631533f, 0.0258462931960821f, -0.0548553243279457f, 0.0316487178206444f, -0.0006758662639186f, -0.0349415540695190f, 0.0265028178691864f, -0.0057704704813659f, -0.0221712477505207f, -0.0086904894560575f, 0.0469752512872219f, 0.0406283289194107f, 0.0680202990770340f, 0.0107057346031070f, 0.1207760944962502f, -0.0188502483069897f, -0.0099176606163383f, 0.0105295581743121f, -0.0102033158764243f, -0.0752666816115379f, 0.0120954560115933f, 0.0033165395725518f, -0.0482803285121918f, 0.0051064686849713f, 0.0488144122064114f, -0.0070172757841647f, 0.0175849087536335f, -0.0043811714276671f, 0.0073827342130244f, 0.0332597531378269f, -0.0046380148269236f, -0.0252619590610266f, -0.0163405686616898f});
        textEmbeddings.put("a crowded plaza", new float[]{-0.0089590139687061f, 0.0168352108448744f, 0.0042456113733351f, 0.0112045221030712f, -0.0117776673287153f, -0.0291208866983652f, -0.0266620051115751f, -0.0967177227139473f, -0.0071255350485444f, 0.0046606995165348f, 0.0131995175033808f, -0.0232483707368374f, 0.0009541650069878f, 0.0059570255689323f, -0.0140245286747813f, 0.0421005748212337f, -0.0396302379667759f, 0.0104605117812753f, -0.0140677345916629f, -0.0271299332380295f, 0.0317938774824142f, -0.0110024539753795f, 0.0550279542803764f, -0.0539579354226589f, -0.0140148000791669f, 0.0547428801655769f, -0.0139147965237498f, -0.0334340967237949f, 0.0393789820373058f, -0.0121286753565073f, 0.0701186135411263f, -0.0391597710549831f, 0.0123241199180484f, 0.0016493084840477f, -0.0336647257208824f, -0.0335779935121536f, 0.0267135500907898f, 0.0122657241299748f, -0.0350313261151314f, 0.0147799598053098f, 0.0071494518779218f, 0.0357270389795303f, 0.0052318507805467f, 0.0594966448843479f, 0.0626230016350746f, -0.0106288669630885f, -0.0227842032909393f, 0.0059040091000497f, -0.0041088308207691f, -0.0051070572808385f, -0.0140446517616510f, 0.0067856088280678f, 0.0090020950883627f, -0.0216947421431541f, -0.0028999603819102f, 0.0162213444709778f, 0.0119320303201675f, 0.0252300240099430f, 0.0314935334026814f, 0.0301541313529015f, 0.0105151068419218f, 0.0052906679920852f, 0.0248348060995340f, 0.0116521352902055f, -0.0268014539033175f, 0.0069514531642199f, -0.0041312188841403f, 0.0173502378165722f, 0.0126152457669377f, 0.0183814074844122f, -0.0224252473562956f, -0.0131419925019145f, 0.0016486204694957f, 0.0021915521938354f, 0.0112400194630027f, -0.0215470399707556f, 0.0109641663730145f, 0.0228280909359455f, 0.0056319250725210f, -0.0415789373219013f, -0.0147697562351823f, 0.0002056539233308f, -0.0217010714113712f, 0.0238160230219364f, -0.0249395463615656f, -0.0021724333055317f, -0.0327837839722633f, 0.0152872595936060f, -0.0119186080992222f, -0.0060470714233816f, -0.0017749437829480f, -0.0363354720175266f, -0.1205282807350159f, 0.0752415433526039f, 0.0076657272875309f, -0.0023003800306469f, 0.0270230267196894f, 0.0191303454339504f, 0.0059322072193027f, -0.0129072871059179f, 0.0012642800575122f, -0.0171046946197748f, 0.0498638749122620f, -0.0147861549630761f, -0.0394218564033508f, -0.0387385711073875f, -0.0301757548004389f, 0.0407174602150917f, -0.0259595829993486f, -0.0061895819380879f, -0.0410620085895061f, -0.0456908829510212f, 0.0073391655460000f, 0.0202804896980524f, -0.0199429541826248f, 0.0064088124781847f, -0.0025695518124849f, 0.0060234880074859f, 0.0219267923384905f, 0.0113634597510099f, -0.0050210161134601f, -0.0517547912895679f, -0.0421875417232513f, 0.0020994918886572f, -0.0397466681897640f, 0.0092454552650452f, -0.0389459542930126f, -0.0339668169617653f, 0.0121396649628878f, 0.0075218765996397f, 0.0234326757490635f, 0.0109620224684477f, 0.0008009936427698f, 0.5522601604461670f, -0.0557866394519806f, -0.0127730891108513f, -0.0285343602299690f, -0.0552600808441639f, -0.0079826358705759f, 0.0022599392104894f, -0.0251843817532063f, -0.0222252625972033f, -0.0733770579099655f, -0.0149553855881095f, 0.0017134589143097f, -0.0026389195118099f, 0.0092543251812458f, -0.0432515926659107f, -0.0198374800384045f, -0.0027370753232390f, -0.0242115966975689f, -0.0049550151452422f, 0.0399636887013912f, 0.0192386806011200f, 0.0014238738222048f, -0.0259644128382206f, -0.0003064157499466f, 0.0244723465293646f, -0.0162731856107712f, -0.0005763696390204f, -0.0428115613758564f, -0.0143236937001348f, 0.0018972089746967f, -0.0157435964792967f, -0.0153019204735756f, 0.0016069250414148f, 0.0100463330745697f, -0.0179447811096907f, -0.0112509336322546f, 0.0176922045648098f, 0.0037625359836966f, 0.0217624139040709f, -0.0142258908599615f, 0.0286994669586420f, -0.0329040475189686f, -0.0290035884827375f, -0.0762272104620934f, 0.0024316904600710f, 0.0169534664601088f, 0.0085459910333157f, 0.0317997559905052f, -0.0042814584448934f, -0.0304830148816109f, -0.0386452414095402f, -0.0053795594722033f, 0.0111751426011324f, -0.0012317791115493f, -0.0162054821848869f, 0.0246405936777592f, 0.0503501854836941f, 0.0118593741208315f, 0.0334741733968258f, -0.0067440243437886f, 0.0089704906567931f, 0.0070703155361116f, -0.0317003652453423f, 0.0078076953068376f, 0.0183307677507401f, 0.0144620975479484f, 0.0041489736177027f, 0.0100762611255050f, -0.0160557273775339f, 0.0175612699240446f, 0.0048229624517262f, 0.0095379948616028f, -0.0385427884757519f, 0.0188677851110697f, -0.0200310759246349f, -0.0057610599324107f, -0.0081431251019239f, 0.0801423341035843f, 0.0118650989606977f, -0.0154564063996077f, -0.0011654944391921f, 0.0259117968380451f, -0.0211910549551249f, 0.0063002915121615f, -0.0408787131309509f, 0.0444657243788242f, -0.0513025075197220f, -0.0112069267779589f, 0.0150296948850155f, -0.0210770871490240f, 0.0170199926942587f, -0.0029749383684248f, 0.0059938356280327f, 0.0215330906212330f, -0.0050140270031989f, -0.0063099903054535f, -0.0164638105779886f, 0.0170883107930422f, -0.0212003905326128f, -0.0031258151866496f, -0.0329528786242008f, 0.0280382689088583f, 0.0269108153879642f, -0.0124819595366716f, -0.0283219702541828f, -0.0123204682022333f, 0.0022128948476166f, -0.0158959068357944f, -0.0201889518648386f, -0.0051337326876819f, -0.0244778431952000f, -0.0486109778285027f, 0.0349821038544178f, -0.0063963280990720f, 0.0024718181230128f, -0.0538306683301926f, -0.0313287004828453f, 0.0044674831442535f, 0.0272865965962410f, 0.0109295351430774f, -0.0110348137095571f, 0.0279722828418016f, -0.0040772203356028f, 0.0008806254481897f, 0.0253298841416836f, 0.0475717037916183f, 0.0129143921658397f, 0.0292747765779495f, -0.0005837671342306f, -0.0191006232053041f, -0.0067289746366441f, -0.0182369500398636f, -0.0289777144789696f, 0.0314857326447964f, -0.0191602371633053f, -0.0071193738840520f, -0.0174548942595720f, -0.0109595442190766f, -0.0235921107232571f, -0.0049792993813753f, -0.0095541458576918f, -0.0023136162199080f, 0.0076287817209959f, -0.0038283881731331f, 0.0053421449847519f, 0.0158087462186813f, 0.0093767214566469f, 0.0143232615664601f, 0.0131634008139372f, 0.0312649607658386f, -0.0234608333557844f, 0.0120837306603789f, 0.0177954453974962f, 0.0102665545418859f, -0.0078677758574486f, 0.0096849733963609f, -0.0395057722926140f, -0.0048695714212954f, -0.0151697332039475f, -0.0084269493818283f, -0.0040756519883871f, 0.0005003169644624f, 0.0088133206591010f, -0.0135132381692529f, 0.0063256346620619f, -0.0081192096695304f, 0.0205435734242201f, 0.0214641075581312f, -0.0120473485440016f, 0.0003752186603379f, 0.0317011363804340f, 0.0071343504823744f, 0.0136271193623543f, 0.0271077360957861f, 0.0221716668456793f, 0.0458164624869823f, 0.0472319312393665f, -0.0211788378655910f, 0.0415536724030972f, 0.5518207550048828f, 0.0208670999854803f, -0.0000433140266978f, 0.0164814461022615f, -0.0137879913672805f, -0.0154509292915463f, -0.0065622697584331f, 0.0637548938393593f, 0.0071743265725672f, 0.0220238212496042f, 0.0308394599705935f, 0.0155995450913906f, 0.0019206629367545f, -0.0196330342441797f, -0.0400561764836311f, 0.0030136662535369f, -0.0089047448709607f, -0.1636610180139542f, -0.0211809705942869f, 0.0767822936177254f, 0.0472889579832554f, -0.0240098610520363f, -0.0042362855747342f, 0.0163796599954367f, -0.0210232865065336f, 0.0130566330626607f, -0.0209701731801033f, 0.0074212546460330f, -0.0318596474826336f, -0.0006670109578408f, 0.0046212687157094f, -0.0283592417836189f, 0.0215791612863541f, 0.0205981843173504f, 0.0043650418519974f, 0.0034030536189675f, 0.0101574035361409f, -0.0150866452604532f, -0.0437915772199631f, -0.0396510213613510f, 0.0430037267506123f, 0.0236464962363243f, -0.0812398865818977f, -0.0463903993368149f, -0.0455945134162903f, 0.0427407845854759f, 0.0060844412073493f, -0.0137153314426541f, -0.0231934487819672f, -0.0208118949085474f, 0.0145820090547204f, 0.0119575718417764f, -0.0075107114389539f, -0.0001304825709667f, -0.0228791944682598f, 0.0394142828881741f, -0.0072057051584125f, 0.0294643640518188f, -0.0474870204925537f, -0.0003264354018029f, -0.0152815049514174f, 0.0071876421570778f, 0.0379554517567158f, 0.0660237893462181f, -0.0032175534870476f, 0.0145211014896631f, 0.0315962247550488f, 0.0219791736453772f, 0.0257780291140079f, 0.0156884267926216f, 0.0117374612018466f, -0.0088807670399547f, -0.0279678329825401f, -0.0219676923006773f, -0.0244778599590063f, 0.0006703888066113f, -0.0223589818924665f, 0.0018470518989488f, -0.0033576870337129f, -0.0395283699035645f, 0.0416641905903816f, 0.0121000455692410f, 0.0116937113925815f, 0.0052978140302002f, 0.0201965626329184f, -0.0093606188893318f, 0.0173934996128082f, 0.0101398443803191f, 0.0417058207094669f, -0.0027193366549909f, -0.0240969117730856f, 0.0233329515904188f, -0.0208658035844564f, -0.0221978724002838f, -0.0109002720564604f, -0.0343048349022865f, -0.0136768007650971f, 0.0001882248179754f, -0.0096845785155892f, -0.0027309055440128f, 0.0023002689704299f, 0.0148555841296911f, -0.0224676523357630f, 0.0206679832190275f, 0.0278460606932640f, -0.0179882682859898f, 0.0273810941725969f, -0.0124684674665332f, 0.0180854555219412f, -0.0152354342862964f, -0.0477498099207878f, -0.0553735978901386f, -0.0066652772948146f, -0.0479152612388134f, -0.0510530211031437f, -0.0148484474048018f, 0.0360674671828747f, 0.0028507891111076f, -0.0008791269501671f, -0.0427375771105289f, 0.0038211776409298f, -0.0003311546170153f, 0.0191498864442110f, -0.0455636680126190f, 0.0103453481569886f, 0.0140692666172981f, 0.0305430665612221f, 0.0174922291189432f, -0.0175534319132566f, -0.0386464186012745f, 0.0065141520462930f, -0.0347548648715019f, 0.0137231117114425f, -0.0278798583894968f, 0.0008347811526619f, -0.0450716838240623f, -0.0061772083863616f, 0.0094556286931038f, -0.0604975894093513f, 0.0176240336149931f, -0.0159620121121407f, 0.0744861066341400f, 0.0041177058592439f, -0.0080100083723664f, 0.0212444290518761f, -0.0252324845641851f, -0.0041165216825902f, -0.0147012239322066f, 0.0022170078009367f, -0.0173844546079636f, 0.0038702178280801f, 0.0421642698347569f, 0.0135008171200752f, -0.0057321521453559f, 0.0061740186065435f, -0.0556419678032398f, 0.0180129464715719f, -0.0361236147582531f, 0.0035325568169355f, -0.0307310447096825f, -0.0070375585928559f, -0.0261689871549606f, 0.0613318420946598f, 0.0191792603582144f, 0.0051484992727637f, -0.0235289223492146f, -0.0237251855432987f, 0.0476211756467819f, -0.0146370725706220f, -0.0782828107476234f, -0.0027962869498879f, 0.0025771583896130f, 0.0011777472682297f, 0.0192499142140150f, 0.0537542700767517f, -0.0207975935190916f, -0.0167525205761194f, 0.0176264829933643f, 0.0337356962263584f, -0.0029352314304560f, 0.0156426690518856f, 0.0843269526958466f, 0.0446901284158230f, 0.0086165750399232f, 0.0414413399994373f, -0.0112601928412914f, -0.0088089499622583f, 0.0043621351942420f, 0.0155217396095395f, -0.0021464319434017f, -0.0180179569870234f, 0.0312833264470100f, -0.0187576618045568f, -0.0099037569016218f, -0.0240033958107233f, -0.0000760368566262f, 0.0141621204093099f, -0.0204245988279581f, -0.0150870503857732f, 0.0107583757489920f});
        textEmbeddings.put("a public park during the day", new float[]{-0.0236391481012106f, 0.0329662598669529f, 0.0202642828226089f, -0.0257311202585697f, -0.0100927054882050f, -0.0196577720344067f, -0.0056537175551057f, -0.0552135892212391f, -0.0192940942943096f, 0.0189502667635679f, -0.0142774432897568f, -0.0450649335980415f, -0.0570757724344730f, -0.0118740117177367f, 0.0001132558754762f, -0.0016829032683745f, -0.0200228467583656f, 0.0134750725701451f, -0.0342751592397690f, -0.0379156842827797f, 0.0529237203299999f, 0.0226070862263441f, 0.0075991908088326f, -0.0307883899658918f, 0.0096557810902596f, 0.0071498560719192f, -0.0209854952991009f, 0.0003694796760101f, 0.0227350369095802f, -0.0106348460540175f, 0.0267416834831238f, 0.0099115073680878f, 0.0217260681092739f, 0.0102603184059262f, -0.0439310148358345f, -0.0069978912360966f, 0.0151114929467440f, -0.0034991002175957f, -0.0046398960985243f, 0.0111234541982412f, -0.0122172608971596f, -0.0087076015770435f, 0.0503354854881763f, 0.0681786388158798f, 0.0771405324339867f, -0.0114019280299544f, 0.0158328041434288f, 0.0037913420237601f, -0.0185488816350698f, -0.0176078919321299f, 0.0044817118905485f, 0.0107642477378249f, 0.0150985522195697f, -0.0244094431400299f, 0.0076353033073246f, 0.0111374435946345f, 0.0222113411873579f, 0.0362957715988159f, -0.0270081795752048f, 0.0137999802827835f, 0.0264106523245573f, -0.0139236291870475f, 0.0335665829479694f, 0.0348236635327339f, -0.0021055615507066f, 0.0041741407476366f, -0.0119578083977103f, 0.0596692636609077f, -0.0008990566711873f, 0.0093108462169766f, -0.0122862057760358f, -0.0088207973167300f, -0.0097883306443691f, 0.0241841264069080f, 0.0377658531069756f, -0.0119832595810294f, 0.0177206415683031f, 0.0242852196097374f, -0.0009007058688439f, -0.0058647654950619f, 0.0054562310688198f, 0.0440174341201782f, -0.0247720591723919f, 0.0487444773316383f, 0.0045661847107112f, 0.0056863087229431f, -0.0643412545323372f, 0.0009107802179642f, 0.0089479787275195f, -0.0028149832505733f, 0.0065554361790419f, -0.0162877645343542f, -0.1012175604701042f, 0.0391877405345440f, 0.0000430128711741f, -0.0088179269805551f, 0.0025465667713434f, 0.0253440700471401f, -0.0280077811330557f, -0.0270605906844139f, -0.0006242626113817f, 0.0079862987622619f, 0.0533802993595600f, -0.0272278189659119f, -0.0432595275342464f, -0.0495930276811123f, -0.0181696359068155f, 0.0507552586495876f, -0.0243629198521376f, -0.0214265361428261f, -0.0461896955966949f, -0.0529541149735451f, -0.0093067949637771f, 0.0381827317178249f, 0.0012222016230226f, -0.0085394475609064f, 0.0074390047229826f, -0.0112191345542669f, -0.0245579816401005f, -0.0038246093317866f, 0.0459729656577110f, -0.0445421673357487f, -0.0163428094238043f, -0.0364312641322613f, 0.0067240879870951f, 0.0104792881757021f, -0.0251977462321520f, -0.0048419446684420f, 0.0097763556987047f, 0.0221667699515820f, 0.0173717513680458f, 0.0286265388131142f, -0.0076410085894167f, 0.5840994119644165f, -0.0053795287385583f, -0.0162009056657553f, -0.0047692540101707f, -0.0623503066599369f, -0.0138710606843233f, -0.0068638171069324f, -0.0124793974682689f, -0.0017310656839982f, -0.0273432806134224f, -0.0037047856021672f, -0.0020332331769168f, 0.0003873987880070f, -0.0024618215393275f, -0.0376977510750294f, -0.0222492404282093f, 0.0034470595419407f, -0.0445181764662266f, -0.0175658334046602f, 0.0394607409834862f, 0.0419130288064480f, 0.0144192855805159f, -0.0193230509757996f, -0.0100620938464999f, 0.0063611445948482f, -0.0132956346496940f, -0.0285148881375790f, -0.0067876996472478f, -0.0254388265311718f, -0.0016905252123252f, 0.0005076186498627f, 0.0032126950100064f, -0.0278235767036676f, 0.0375047214329243f, 0.0021798524539918f, -0.0218327790498734f, 0.0069685601629317f, -0.0053347675129771f, -0.0019727379549295f, 0.0105273043736815f, 0.0163338594138622f, -0.0183713603764772f, -0.0036322809755802f, -0.0127003341913223f, -0.0104902219027281f, -0.0093456842005253f, 0.0270288102328777f, 0.0047599719837308f, -0.0203437320888042f, -0.0063519193790853f, -0.0626664012670517f, -0.0330836176872253f, 0.0192826166749001f, -0.0174494925886393f, -0.0255652070045471f, -0.0004099508223590f, -0.0055517340078950f, 0.0066718822345138f, 0.0226565841585398f, 0.0353793986141682f, 0.0070357560180128f, -0.0438454300165176f, -0.0389214083552361f, -0.0008244253695011f, 0.0198709592223167f, 0.0434183068573475f, -0.0193979628384113f, -0.0095845190808177f, 0.0039078933186829f, -0.0179685484617949f, 0.0158451218158007f, 0.0075193522498012f, -0.0005736033781432f, 0.0146585851907730f, -0.0122079886496067f, -0.0125424033030868f, -0.0174420326948166f, 0.0555072054266930f, -0.0181339755654335f, -0.0040071657858789f, 0.0241732429713011f, 0.0179877430200577f, -0.0070753558538854f, 0.0027937057893723f, -0.0193860530853271f, 0.0293805878609419f, -0.0484263226389885f, -0.0121259866282344f, 0.0119324084371328f, -0.0156938582658768f, -0.0149288456887007f, -0.0093587795272470f, 0.0022459267638624f, 0.0054057901725173f, 0.0100035211071372f, -0.0197744611650705f, -0.0335216671228409f, 0.0115505522117019f, -0.0009869361529127f, -0.0150053920224309f, -0.0032340118195862f, -0.0040419134311378f, 0.0001737402053550f, -0.0307112876325846f, 0.0087769888341427f, -0.0128523278981447f, -0.0375640876591206f, 0.0082338871434331f, -0.0263224374502897f, -0.0057588969357312f, 0.0222228392958641f, -0.0322500988841057f, 0.0243239738047123f, 0.0376961529254913f, 0.0076547777280211f, -0.0244927238672972f, -0.0186853632330894f, -0.0383383408188820f, 0.0056742364540696f, 0.0206574406474829f, -0.0011227950453758f, -0.0061147795058787f, 0.0095574585720897f, -0.0082327779382467f, 0.0087344869971275f, 0.0791275352239609f, 0.0346507132053375f, -0.0166512485593557f, 0.0172338616102934f, -0.0243789982050657f, 0.0203718803822994f, 0.0012484781909734f, -0.0220921151340008f, 0.0180659629404545f, 0.0043756612576544f, -0.0034320817794651f, 0.0019748106133193f, -0.0039618695154786f, -0.0156464427709579f, 0.0308095999062061f, -0.0085491267964244f, -0.0059423842467368f, 0.0255996081978083f, -0.0028276683297008f, -0.0044955904595554f, 0.0068627200089395f, 0.0051751262508333f, 0.0087776519358158f, -0.0057069156318903f, -0.0078076757490635f, 0.0163256935775280f, -0.0021555237472057f, -0.0234606973826885f, -0.0005666427896358f, 0.0004806778451893f, 0.0302723031491041f, -0.0074582234956324f, 0.0095409974455833f, -0.0042560175061226f, 0.0035490691661835f, 0.0236844979226589f, -0.0076165045611560f, -0.0122389448806643f, 0.0090946955606341f, 0.0026875273324549f, -0.0123297115787864f, -0.0114280786365271f, 0.0363743938505650f, -0.0223631504923105f, -0.0170813407748938f, 0.0126549135893583f, -0.0072460006922483f, 0.0248183757066727f, 0.0175310485064983f, 0.0337555073201656f, 0.0287117697298527f, 0.0306118149310350f, 0.0113014392554760f, 0.0127874333411455f, 0.5842408537864685f, -0.0190578941255808f, 0.0141741400584579f, 0.0138613339513540f, -0.0040729162283242f, -0.0085106072947383f, -0.0061713419854641f, 0.0074742133729160f, -0.0156312137842178f, 0.0345075502991676f, 0.0252865366637707f, -0.0006551619153470f, -0.0450216718018055f, 0.0015097109135240f, -0.0151546616107225f, -0.0222233533859253f, -0.0064609316177666f, -0.0955586284399033f, 0.0049640792421997f, 0.0446076393127441f, 0.0257979650050402f, -0.0112818125635386f, -0.0182566419243813f, 0.0035924725234509f, 0.0091260978952050f, -0.0025574879255146f, 0.0087525732815266f, -0.0231182370334864f, -0.0275416038930416f, -0.0319920293986797f, 0.0328718237578869f, -0.0242915283888578f, 0.0072191362269223f, 0.0136446338146925f, 0.0092985276132822f, -0.0032326674554497f, 0.0228080712258816f, 0.0267336368560791f, -0.0364442877471447f, -0.0255127940326929f, 0.0505087710916996f, 0.0480594821274281f, -0.0521763525903225f, -0.0050804466009140f, 0.0103818345814943f, 0.0152844367548823f, -0.0153453974053264f, -0.0228392165154219f, -0.0102474987506866f, -0.0338813997805119f, -0.0429707132279873f, 0.0121632181107998f, -0.0148396622389555f, -0.0408449359238148f, -0.0018201505299658f, 0.0081321047618985f, -0.0083541506901383f, 0.0087716327980161f, -0.0326640829443932f, 0.0314299762248993f, -0.0139296678826213f, 0.0163657907396555f, 0.0308712180703878f, 0.0060516474768519f, 0.0135092288255692f, 0.0038938848301768f, 0.0055409623309970f, 0.0098581546917558f, 0.0181858930736780f, 0.0237799379974604f, 0.0028309968765825f, -0.0190393738448620f, -0.0259987525641918f, -0.0143504133448005f, -0.0310975294560194f, 0.0297076180577278f, -0.0290166977792978f, -0.0021079047583044f, -0.0369623415172100f, 0.0059879114851356f, 0.0449520871043205f, 0.0015559204621240f, 0.0097179813310504f, -0.0069442414678633f, 0.0033723115921021f, 0.0059354160912335f, 0.0341916196048260f, 0.0331120006740093f, 0.0356809943914413f, -0.0243464168161154f, -0.0401791036128998f, 0.0380885116755962f, -0.0183987654745579f, -0.0179445147514343f, -0.0126437284052372f, -0.0075006471015513f, 0.0056290216743946f, 0.0047510042786598f, -0.0199210178107023f, -0.0196651332080364f, -0.0014521259581670f, 0.0073447078466415f, -0.0223926994949579f, -0.0278899874538183f, 0.0271460190415382f, -0.0224138349294662f, 0.0285006873309612f, 0.0210098177194595f, 0.0525077581405640f, 0.0000331122573698f, 0.0033980989828706f, -0.0802431926131248f, 0.0005532701616175f, -0.0347615852952003f, -0.0078522814437747f, -0.0048528485931456f, 0.0174420755356550f, -0.0004317642888054f, 0.0241507142782211f, -0.0020345214288682f, -0.0055198008194566f, -0.0097643872722983f, -0.0207899138331413f, 0.0026309022214264f, -0.0211432836949825f, 0.0153776844963431f, 0.0100128808990121f, -0.0111575350165367f, -0.0207017380744219f, 0.0120130302384496f, 0.0335977487266064f, -0.0047274134121835f, -0.0068617993965745f, -0.0100910654291511f, -0.0021897011902183f, -0.0200434271246195f, -0.0231764763593674f, 0.0289372745901346f, -0.0638467073440552f, 0.0459591075778008f, -0.0211191270500422f, 0.0602888166904449f, 0.0234778262674809f, -0.0460862517356873f, 0.0297180972993374f, 0.0035938078071922f, 0.0163178760558367f, -0.0260256920009851f, -0.0043342821300030f, 0.0183757934719324f, 0.0108376108109951f, 0.0274103451520205f, 0.0226644184440374f, 0.0223572868853807f, -0.0009163956856355f, -0.0252643935382366f, -0.0145053677260876f, -0.0016024330398068f, 0.0115430867299438f, -0.0026108934544027f, 0.0162906143814325f, 0.0039528952911496f, 0.0590635910630226f, 0.0151111390441656f, 0.0112197315320373f, -0.0213677845895290f, -0.0460900589823723f, 0.0439408645033836f, 0.0086441664025187f, -0.0623096786439419f, 0.0202867779880762f, 0.0123901711776853f, 0.0424725338816643f, 0.0091763939708471f, 0.0015191753627732f, -0.0155991055071354f, 0.0152196940034628f, -0.0008528106845915f, 0.0109952827915549f, 0.0243613589555025f, 0.0219567846506834f, 0.0802316293120384f, 0.0259027034044266f, -0.0085138985887170f, -0.0149291492998600f, -0.0164592042565346f, -0.0149888414889574f, -0.0081734014675021f, -0.0217522475868464f, 0.0339101850986481f, 0.0244263671338558f, 0.0530688725411892f, 0.0440140217542648f, -0.0182925872504711f, -0.0035787106025964f, -0.0114538641646504f, -0.0058370172046125f, -0.0286571700125933f, -0.0285748112946749f, -0.0181410908699036f});
        textEmbeddings.put("a well-lit office", new float[]{-0.0187516938894987f, 0.0027244843076915f, 0.0077067795209587f, 0.0201604589819908f, 0.0002893632918131f, -0.0333266481757164f, -0.0171217955648899f, -0.0826906561851501f, -0.0283620208501816f, 0.0424037128686905f, 0.0164184588938951f, -0.0040742745622993f, 0.0393858663737774f, -0.0173360146582127f, -0.0183427501469851f, 0.0128169041126966f, -0.0109763834625483f, 0.0104849543422461f, 0.0057591339573264f, 0.0227137338370085f, 0.0327393785119057f, -0.0169280804693699f, 0.0174621399492025f, -0.0091842440888286f, -0.0134563921019435f, 0.0223504230380058f, -0.0138353109359741f, -0.0363886877894402f, 0.0153774451464415f, -0.0057572382502258f, 0.0093944631516933f, 0.0267310570925474f, 0.0333057940006256f, -0.0118676899001002f, -0.0588903836905956f, -0.0077855871059000f, 0.0109777320176363f, 0.0033342575188726f, 0.0371842905879021f, -0.0212167557328939f, -0.0665654018521309f, -0.0151260141283274f, 0.0247334111481905f, 0.0085803288966417f, -0.0089061763137579f, -0.0116681102663279f, 0.0085331359878182f, -0.0080625852569938f, -0.0186874736100435f, 0.0420335642993450f, -0.0073000728152692f, -0.0336595028638840f, 0.0087663568556309f, -0.0098526999354362f, -0.0163887739181519f, 0.0111332908272743f, -0.0506878755986691f, -0.0094880275428295f, -0.0282886922359467f, 0.0059057585895061f, -0.0300485920161009f, -0.0028647121507674f, 0.0073474403470755f, 0.0070271645672619f, 0.0318244397640228f, -0.0208994913846254f, 0.0003592604480218f, -0.0156889520585537f, 0.0131940701976418f, -0.0230860169976950f, 0.0206952430307865f, -0.0023907516151667f, 0.0176224280148745f, 0.0077101942151785f, 0.0075370003469288f, 0.0127424318343401f, 0.0304887089878321f, -0.0011566514149308f, 0.0065313871018589f, 0.0235682744532824f, -0.0330781899392605f, 0.0111867366358638f, -0.0265666544437408f, 0.0331859104335308f, -0.0145494928583503f, 0.0215206835418940f, 0.0101057440042496f, -0.0009802468121052f, -0.0213558021932840f, 0.0104039674624801f, -0.0021431914065033f, -0.0422674268484116f, -0.1321021616458893f, -0.0413265116512775f, -0.0402961000800133f, 0.0256810933351517f, -0.0413547903299332f, 0.0502483434975147f, 0.0579532496631145f, -0.0152316074818373f, -0.0299319811165333f, 0.0200463701039553f, 0.0435422435402870f, -0.0136813083663583f, 0.0229400228708982f, -0.0518143363296986f, -0.0235742349177599f, -0.0002236383734271f, 0.0317420214414597f, -0.0193089321255684f, -0.0383943468332291f, -0.0143214203417301f, -0.0047898674383759f, 0.0103905554860830f, 0.0099774412810802f, 0.0125270038843155f, -0.0031277381349355f, 0.0095210373401642f, -0.0024905649479479f, 0.0227699875831604f, 0.0215631555765867f, -0.0189242083579302f, -0.0166106056421995f, -0.0321939624845982f, 0.0029051834717393f, -0.0221977289766073f, 0.0107754301279783f, -0.0019977793563157f, 0.0130204176530242f, -0.0145316356793046f, 0.0048332624137402f, -0.0207888316363096f, 0.0024420656263828f, 0.5545517206192017f, 0.0003392038925085f, 0.0121325179934502f, -0.0393564403057098f, -0.0777771994471550f, 0.0172444321215153f, 0.0150827113538980f, 0.0015469307545573f, 0.0155111821368337f, -0.0292361211031675f, 0.0310021098703146f, 0.0005660050665028f, 0.0107024451717734f, 0.0240534655749798f, -0.0388365425169468f, 0.0167127121239901f, -0.0344853475689888f, -0.0301995854824781f, -0.0403803624212742f, 0.0167755056172609f, 0.0502482578158379f, -0.0071803634054959f, -0.0180743653327227f, 0.0077173076570034f, -0.0203640609979630f, 0.0110290143638849f, -0.0225154049694538f, 0.0266978833824396f, 0.0214693248271942f, 0.0111604090780020f, -0.0194524824619293f, -0.0208732821047306f, 0.0173142328858376f, 0.0048105185851455f, -0.0117415366694331f, -0.0202590320259333f, -0.0142226293683052f, 0.0070835067890584f, -0.0146418819203973f, 0.0251407809555531f, 0.0060237618163228f, -0.0057634008117020f, 0.0560369081795216f, -0.0313711129128933f, -0.0272139422595501f, 0.0378270074725151f, -0.0076830722391605f, 0.0072381729260087f, 0.0180693287402391f, -0.0472477525472641f, -0.0107082845643163f, -0.0079979011788964f, -0.0350063592195511f, 0.0018932841485366f, 0.0016981317894533f, -0.0453217029571533f, 0.0090228142216802f, 0.0272895153611898f, 0.0673897564411163f, 0.0122749935835600f, -0.0478094480931759f, 0.0201653223484755f, -0.0206770934164524f, 0.0112881716340780f, 0.0195928867906332f, -0.0247381404042244f, 0.0010142931714654f, -0.0072134872898459f, 0.0470193512737751f, 0.0297348015010357f, 0.0375438518822193f, -0.0126870106905699f, -0.0007357946597040f, -0.0059097423218191f, -0.0080021489411592f, -0.0123522067442536f, -0.0342652685940266f, 0.0251931212842464f, -0.0115177705883980f, 0.0333981215953827f, 0.0065932464785874f, 0.0057509988546371f, 0.0103534478694201f, 0.0313575603067875f, -0.0192654188722372f, 0.0210906621068716f, 0.0023537012748420f, 0.0215889401733875f, -0.0174165591597557f, -0.0054122894071043f, -0.0188058093190193f, 0.0264011435210705f, 0.0269821416586637f, 0.0324445664882660f, 0.0304788127541542f, 0.0082676867023110f, -0.0030253452714533f, -0.0298794582486153f, 0.0054163611494005f, 0.0130996340885758f, -0.0227111298590899f, -0.0069892066530883f, 0.0485593937337399f, -0.0198865719139576f, 0.0015202679205686f, -0.0124587938189507f, -0.0432585217058659f, 0.0308317150920630f, -0.0091952290385962f, -0.0323921889066696f, 0.0433594733476639f, -0.0246622748672962f, 0.0805179998278618f, 0.0203336682170630f, -0.0075302119366825f, -0.0133149409666657f, -0.0059355720877647f, -0.0154289836063981f, 0.0364007353782654f, 0.0012114655692130f, -0.0139619121327996f, -0.0009544783970341f, 0.0142429433763027f, 0.0126668177545071f, 0.0025045338552445f, -0.0061130844987929f, 0.0159711893647909f, -0.0039450693875551f, -0.0043241814710200f, -0.0055727991275489f, 0.0254920832812786f, 0.0079455962404609f, 0.0135101312771440f, 0.0029172834474593f, 0.0188235640525818f, -0.0438255853950977f, -0.0088564185425639f, -0.0000598267979512f, 0.0168913453817368f, 0.0324144996702671f, -0.0287130344659090f, 0.0041353390552104f, 0.0058612050488591f, -0.0411083735525608f, -0.0012064402690157f, 0.0140080312266946f, 0.0049615632742643f, 0.0237953029572964f, -0.0207364242523909f, -0.0206223819404840f, -0.0153881348669529f, -0.0434356033802032f, -0.0018646373646334f, -0.0105763161554933f, 0.0131952548399568f, 0.0148329399526119f, -0.0241069924086332f, 0.0405574887990952f, -0.0129802152514458f, 0.0253349486738443f, 0.0420459471642971f, -0.0206319093704224f, -0.0077788066118956f, -0.0024906890466809f, 0.0005100771086290f, 0.0257854573428631f, -0.0106570823118091f, -0.0090168621391058f, 0.0037904407363385f, 0.0221429858356714f, 0.0226294603198767f, -0.0049058995209634f, -0.0015867814654484f, -0.0329998247325420f, 0.0003598049806897f, 0.0378514006733894f, -0.0409650914371014f, -0.0129208182916045f, 0.0417472086846828f, 0.5542652606964111f, -0.0390246026217937f, 0.0105321612209082f, 0.0059078396297991f, -0.0187413319945335f, -0.0243325494229794f, 0.0004564908740576f, 0.0104293730109930f, -0.0078897289931774f, 0.0182554367929697f, 0.0690296888351440f, -0.0004970358568244f, 0.0350284315645695f, 0.0042662727646530f, 0.0169766638427973f, -0.0014038487570360f, 0.0396209470927715f, -0.1935413926839828f, 0.0247495546936989f, 0.0484423413872719f, 0.0368124842643738f, -0.0182122532278299f, 0.0210329554975033f, -0.0151105346158147f, -0.0061053615063429f, 0.0182503592222929f, -0.0212295390665531f, -0.0239834748208523f, -0.0498053021728992f, -0.0039220955222845f, 0.0131370304152369f, 0.0052403751760721f, 0.0492830798029900f, 0.0134496279060841f, 0.0201575830578804f, -0.0077305505983531f, -0.0035462940577418f, 0.0018298473441973f, 0.0054457220248878f, -0.0273166093975306f, 0.0316883698105812f, -0.0067611974664032f, -0.0354854129254818f, -0.0396077036857605f, -0.0219417847692966f, 0.0235857199877501f, 0.0031144821550697f, 0.0131199760362506f, -0.0713924095034599f, -0.0135065102949739f, 0.0075391316786408f, 0.0376428924500942f, 0.0198196116834879f, -0.0175973586738110f, 0.0055472664535046f, -0.0049207480624318f, -0.0165391042828560f, 0.0070408484898508f, 0.0140647506341338f, -0.0211456958204508f, -0.0061625260859728f, -0.0300883613526821f, -0.0091030141338706f, -0.0007702642469667f, -0.0024079387076199f, -0.0015604691579938f, 0.0280111879110336f, -0.0126723749563098f, -0.0092272385954857f, 0.0036445881705731f, 0.0187050160020590f, -0.0193120557814837f, -0.0156516768038273f, 0.0102389296516776f, -0.0274979062378407f, 0.0080329980701208f, -0.0141623588278890f, 0.0109832603484392f, -0.0050332779064775f, 0.0566340833902359f, -0.0142683060839772f, 0.0308585669845343f, -0.0297457259148359f, 0.0397274270653725f, 0.0382356308400631f, -0.0161686949431896f, -0.0329127795994282f, 0.0415201671421528f, 0.0233341660350561f, -0.0194014478474855f, 0.0192935038357973f, 0.0051932511851192f, -0.0032754484564066f, -0.0003745714784600f, -0.0339466147124767f, -0.0378884896636009f, 0.0056394594721496f, -0.0251168850809336f, -0.0016493411967531f, -0.0049103656783700f, -0.0017285959329456f, 0.0574944838881493f, -0.0067514856345952f, 0.0276315771043301f, -0.0195383634418249f, 0.0077192955650389f, 0.0281066223978996f, 0.0305854734033346f, 0.0018658252665773f, -0.0049955234862864f, -0.0052930200472474f, -0.0348647572100163f, -0.0456778593361378f, 0.0016911844722927f, -0.0186347402632236f, 0.0331233814358711f, 0.0148923760280013f, -0.0000459660732304f, 0.0347187817096710f, -0.0091161858290434f, -0.0231929104775190f, 0.0309724677354097f, -0.0347709096968174f, -0.0121766608208418f, -0.0319953262805939f, 0.0346935950219631f, -0.0078455843031406f, -0.0169122125953436f, 0.0106323277577758f, -0.0449716486036777f, -0.0017032807227224f, -0.0010857335291803f, -0.0144128054380417f, -0.0214021131396294f, 0.0178810358047485f, -0.0621514432132244f, -0.0265259910374880f, 0.0032021091319621f, 0.0300823599100113f, 0.0534287914633751f, 0.0152371171861887f, 0.0378112308681011f, 0.0090728346258402f, 0.0043575782328844f, 0.0396518297493458f, 0.0412432514131069f, 0.0282357092946768f, 0.0192356724292040f, 0.0168156251311302f, 0.0151559300720692f, 0.0478747636079788f, 0.0283351875841618f, -0.0028733606450260f, 0.0139010846614838f, 0.0059666940942407f, -0.0017949460307136f, -0.0307276975363493f, 0.0192077588289976f, 0.0274167843163013f, -0.0579875931143761f, -0.0217060763388872f, 0.0050171134062111f, -0.0124105187132955f, -0.0233594961464405f, -0.0038236011750996f, 0.0254489332437515f, -0.0153048653155565f, 0.0521983988583088f, 0.0000944029161474f, -0.0706512480974197f, -0.0118596330285072f, -0.0135038569569588f, 0.0198022965341806f, -0.0051675089634955f, 0.0004031859571114f, -0.0073992833495140f, -0.0259729307144880f, -0.0104847662150860f, 0.0034438942093402f, -0.0103596141561866f, -0.0063950684852898f, 0.1006591990590096f, 0.0187486186623573f, -0.0067686769180000f, 0.0043463665060699f, -0.0047499788925052f, -0.0044102314859629f, 0.0202812906354666f, 0.0412587635219097f, -0.0317037776112556f, -0.0161533504724503f, 0.0463135167956352f, 0.0767169371247292f, 0.0028000592719764f, -0.0310691073536873f, 0.0437787212431431f, 0.0261022672057152f, -0.0513005293905735f, -0.0393125005066395f, 0.0069714011624455f});

    }

    public Object classifyScene(Bitmap bitmap) {
        if (interpreter == null) {
            Log.e(TAG, "Interpreter not initialized.");
            return 0.0f;
        }

        Bitmap scaledBitmap = Bitmap.createScaledBitmap(bitmap, INPUT_SIZE, INPUT_SIZE, true);
        ByteBuffer inputBuffer = convertBitmapToByteBuffer(scaledBitmap);

        float[][] imageEmbeddingOutput = new float[1][EMBEDDING_SIZE];
        interpreter.run(inputBuffer, imageEmbeddingOutput);
        float[] imageEmbedding = imageEmbeddingOutput[0];


        Map<String, Float> similarityScores = new HashMap<>();
        for (Map.Entry<String, float[]> entry : textEmbeddings.entrySet()) {
            String label = entry.getKey();
            float[] textEmbedding = entry.getValue();
            similarityScores.put(label, cosineSimilarity(imageEmbedding, textEmbedding));
        }

        // --- Step 3: Convert similarities to probabilities using Softmax ---
        Map<String, Float> confidenceScores = softmax(similarityScores, SOFTMAX_TEMPERATURE);

        // --- Step 4: Find the best match from the NEW confidence scores ---
        String bestMatchLabel = "unknown";
        float maxConfidence = -1.0f;

        for (Map.Entry<String, Float> entry : confidenceScores.entrySet()) {
            String label = entry.getKey();
            float confidence = entry.getValue();

//            Log.d(TAG, String.format("VERIFY - Confidence for '%s': %.2f%%", label, confidence * 100));

            if (confidence > maxConfidence) {
                maxConfidence = confidence;
                bestMatchLabel = label;
            }
        }

        Log.d(TAG, "Best match: '" + bestMatchLabel + "' with confidence: " + maxConfidence);
        float finalRiskScore = sceneRiskMap.getOrDefault(bestMatchLabel, 0.0f);
        return new ClassificationResult(finalRiskScore, bestMatchLabel, maxConfidence);
    }

    private Map<String, Float> softmax(Map<String, Float> scores, float temperature) {
        Map<String, Float> probabilities = new HashMap<>();
        float sumExp = 0.0f;

        // Calculate the sum of the exponentiated scores
        for (float score : scores.values()) {
            sumExp += (float) Math.exp(score / temperature);
        }

        // Calculate the softmax probability for each score
        for (Map.Entry<String, Float> entry : scores.entrySet()) {
            float probability = (float) (Math.exp(entry.getValue() / temperature) / sumExp);
            probabilities.put(entry.getKey(), probability);
        }

        return probabilities;
    }

    private float cosineSimilarity(float[] vec1, float[] vec2) {
        if (vec1 == null || vec2 == null || vec1.length != vec2.length) {
            return 0.0f;
        }
        float dotProduct = 0.0f;
        float norm1 = 0.0f;
        float norm2 = 0.0f;
        for (int i = 0; i < vec1.length; i++) {
            dotProduct += vec1[i] * vec2[i];
            norm1 += vec1[i] * vec1[i];
            norm2 += vec2[i] * vec2[i];
        }
        float magnitude1 = (float) Math.sqrt(norm1);
        float magnitude2 = (float) Math.sqrt(norm2);
        if (magnitude1 == 0 || magnitude2 == 0) {
            return 0.0f;
        }
        return dotProduct / (magnitude1 * magnitude2);
    }


    private ByteBuffer convertBitmapToByteBuffer(Bitmap bitmap) {
        ByteBuffer byteBuffer = ByteBuffer.allocateDirect(4 * INPUT_SIZE * INPUT_SIZE * 3);
        byteBuffer.order(ByteOrder.nativeOrder());

        int[] intValues = new int[INPUT_SIZE * INPUT_SIZE];
        bitmap.getPixels(intValues, 0, bitmap.getWidth(), 0, 0, bitmap.getWidth(), bitmap.getHeight());

        int pixel = 0;
        for (int i = 0; i < INPUT_SIZE; ++i) {
            for (int j = 0; j < INPUT_SIZE; ++j) {
                final int val = intValues[pixel++];
                // Normalization for FLOAT models. We'll use the [-1, 1] range.
                byteBuffer.putFloat((((val >> 16) & 0xFF) / 127.5f) - 1.0f); // Red
                byteBuffer.putFloat((((val >> 8) & 0xFF) / 127.5f) - 1.0f);  // Green
                byteBuffer.putFloat(((val & 0xFF) / 127.5f) - 1.0f);        // Blue
            }
        }
        return byteBuffer;
    }

    public void close() {
        if (interpreter != null) {
            interpreter.close();
            interpreter = null;
        }
    }
}